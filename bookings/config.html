{{#restrict section="config" level="admin" block=true}}{{/restrict}}
{{#form on="save"}}
	{{:save key="config"
		access=$_POST.access
		manage_access=$_POST.manage_access
		list_access=$_POST.list_access
		prune_months=$_POST.prune_months|intval|or:24
	}}
	{{:redirect to="./manage/?ok=1"}}
{{/form}}

{{:admin_header title="Configuration des accès" current="module_bookings"}}

{{:include file="./_nav.html" current="config" subcurrent="access"}}

<form method="post" action="">
	<fieldset>
		<legend>Qui peut voir et gérer les inscriptions ?</legend>
		<dl>
			{{:input type="radio" name="access" source=$module.config value="none" label="Tous les membres connectés"}}
			{{:input type="radio" name="access" source=$module.config value="read" label="Seulement les membres pouvant lire la liste des membres"}}
			{{:input type="radio" name="access" source=$module.config default="write" value="write" label="Seulement les membres pouvant ajouter et modifier des membres"}}
		</dl>
	</fieldset>
	<fieldset>
		<legend>Qui peut gérer les événements et créneaux ?</legend>
		<dl>
			{{:input type="radio" name="manage_access" source=$module.config value="write" label="Les membres pouvant ajouter et modifier des membres"}}
			{{:input type="radio" name="manage_access" source=$module.config default="admin" value="admin" label="Les membres administrateurs de la gestion des membres"}}
		</dl>
	</fieldset>
	<fieldset>
		<legend>Qui peut voir la liste des événements ?</legend>
		<dl>
			{{:input type="radio" name="list_access" source=$module.config value="all" default="all" label="Tout le monde"}}
			{{:input type="radio" name="list_access" source=$module.config value="users" default="all" label="Seuls les membres connectés"}}
			{{:input type="radio" name="list_access" source=$module.config value="admins" label="Seules les personnes gérant les réservations"}}
		</dl>
	</fieldset>
	<fieldset>
		<legend>Suppression des données</legend>
		<dl>
			{{:input type="number" step="1" min="1" max="60" name="prune_months" source=$module.config default=24 required=true label="Nombre de mois avant suppression automatique des anciennes réservations" help="Si on indique '12' ici, les anciennes réservations seront supprimées un an jour pour jour après leur date, en conformité avec le RGPD."}}
		</dl>
	</fieldset>
	<p class="submit">
		{{:button type="submit" label="Enregistrer" name="save" shape="right" class="main"}}
	</p>
</form>

{{:admin_footer}}